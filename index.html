<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ACM - Valley | HP do RP</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css">
</head>
<body>
    <!-- Barra Lateral -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <a href="#" class="sidebar-brand">
                <i class="bi bi-hospital"></i>
                <span>ACM - Valley</span>
            </a>
        </div>

        <ul class="sidebar-menu">
            <li>
                <a href="#" class="active" onclick="showPage('inicio')">
                    <i class="bi bi-house-door"></i>
                    <span>Início</span>
                </a>
            </li>
            <li>
                <a href="#" onclick="showPage('exames')">
                    <i class="bi bi-clipboard-check"></i>
                    <span>Exames</span>
                </a>
            </li>
            <li>
                <a href="#" onclick="showPage('informes')">
                    <i class="bi bi-megaphone"></i>
                    <span>Informes</span>
                </a>
            </li>
            <li class="admin-only">
                <a href="#" onclick="showPage('admin')">
                    <i class="bi bi-shield-lock"></i>
                    <span>Painel Admin</span>
                </a>
            </li>
            <!-- Botão de Login (vai ser ocultado quando o usuário estiver logado) -->
            <li id="login-menu-item">
                <a href="#" id="login-link">
                    <i class="bi bi-box-arrow-in-right"></i>
                    <span>Login</span>
                </a>
            </li>
            <!-- Botão de Logout (vai ser exibido quando o usuário estiver logado) -->
            <li class="admin-only" id="logout-menu-item">
                <a href="#" id="logout-link">
                    <i class="bi bi-box-arrow-right"></i>
                    <span>Sair</span>
                </a>
            </li>
        </ul>
    </div>

    <!-- Topbar (barra superior) -->
    <div class="topbar">
        <h3 id="current-page-title">Início</h3>
        <div id="user-info">
            <span class="me-3">Bem-vindo, Visitante</span>
            <button class="btn btn-outline-secondary btn-sm" id="login-btn">
                <i class="bi bi-box-arrow-in-right"></i> Login
            </button>
        </div>
    </div>

    <!-- Conteúdo Principal -->
    <div class="main-content" id="main-content">
        <!-- O conteúdo da página será carregado aqui -->
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Configuração do Firebase
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_PROJECT_ID.appspot.com",
            messagingSenderId: "YOUR_SENDER_ID",
            appId: "YOUR_APP_ID"
        };
        firebase.initializeApp(firebaseConfig);

        // Função de controle das páginas
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById(pageId + '-page').classList.add('active');
            const titles = {
                'inicio': 'Início',
                'exames': 'Exames',
                'informes': 'Informes',
                'login': 'Login',
                'admin': 'Painel Admin'
            };
            document.getElementById('current-page-title').textContent = titles[pageId];
        }

        // Verificação de estado de autenticação
        firebase.auth().onAuthStateChanged(async (user) => {
            if (user) {
                // Usuário logado
                updateUserInfo(user);  // Atualiza as informações do usuário

                // Oculta o botão de login na barra lateral
                document.getElementById("login-menu-item").style.display = "none";
                // Exibe o botão de logout na barra lateral
                document.getElementById("logout-menu-item").style.display = "block";

                // Atualiza a mensagem de boas-vindas na barra superior
                document.getElementById("user-info").innerHTML = `
                    <span class="me-3">Bem-vindo, ${user.displayName || user.email}</span>
                    <button class="btn btn-outline-danger btn-sm" id="logout-btn">
                        <i class="bi bi-box-arrow-right"></i> Sair
                    </button>
                `;

                // Evento de clique para logout
                document.getElementById("logout-btn").addEventListener("click", () => {
                    firebase.auth().signOut().then(() => {
                        console.log('Usuário deslogado');
                        showPage('inicio');  // Redireciona para a página inicial após logout
                    }).catch((error) => {
                        console.error('Erro ao deslogar:', error);
                    });
                });
            } else {
                // Usuário não logado
                document.getElementById("login-menu-item").style.display = "block";  // Exibe o botão de login
                document.getElementById("logout-menu-item").style.display = "none";  // Oculta o botão de logout

                // Atualiza a mensagem de boas-vindas para "Visitante"
                document.getElementById("user-info").innerHTML = `
                    <span class="me-3">Bem-vindo, Visitante</span>
                    <button class="btn btn-outline-secondary btn-sm" id="login-btn">
                        <i class="bi bi-box-arrow-in-right"></i> Login
                    </button>
                `;

                // Evento de clique para login
                document.getElementById("login-btn").addEventListener("click", () => {
                    showPage('login');  // Mostra a página de login
                });
            }
        });

        // Função de login
        function login() {
            const email = document.getElementById("email").value;
            const password = document.getElementById("password").value;

            firebase.auth().signInWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    // Usuário logado com sucesso
                    const user = userCredential.user;
                    updateUserInfo(user);
                })
                .catch((error) => {
                    console.error("Erro ao fazer login: ", error.message);
                });
        }

        // Atualiza informações do usuário
        function updateUserInfo(user) {
            console.log("Usuário logado:", user);
        }
    </script>
</body>
</html>
